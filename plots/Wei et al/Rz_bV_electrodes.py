import matplotlib.pyplot as plt
import numpy as np

# The parameters are according to Fig S2b

slabel = ["N",
          "hmin",
          "distance of electrodes [nm]",
          "biased voltage @ +-150 nm",
          ]

N_hmin_Rz_Javg_pnp_200bmV = [[99138, 8.855334845344043e-12, 2.5000000000000004e-07, 9125.0094077958], [95697, 1.488875970977545e-11, 5.000000000000001e-07, 8784.570949824007], [96365, 1.488875970977545e-11, 7.5e-07, 8537.471046716411], [87878, 2.2149131655735147e-11, 1.0000000000000002e-06, 8253.437795042697], [93431, 2.2110517788806754e-11, 1.2499999999999999e-06, 7847.33182431304], [95454, 1.6040213900490875e-11, 1.5e-06, 7751.3220187479665], [99710, 1.4888759709721926e-11, 1.7500000000000002e-06, 7379.873466278756], [88350, 1.6040213900490875e-11, 2e-06, 7327.144779882778], [91209, 1.6040213900490875e-11, 2.25e-06, 7090.999197934296], [95048, 1.6040213900490875e-11, 2.5e-06, 6897.519472905111]]
filestr = '2015-06-25_12h31.json'

N_hmin_Rz_bV_rzv_pnp_200bmV = [[99138, 8.855334845344043e-12, 2.5000000000000004e-07, 0.18905156293152403, 1.5000000000000002e-07], [95697, 1.488875970977545e-11, 5.000000000000001e-07, 0.18206189506422477, 1.5000000000000002e-07], [96365, 1.488875970977545e-11, 7.5e-07, 0.17693008186660544, 1.5000000000000002e-07], [87878, 2.2149131655735147e-11, 1.0000000000000002e-06, 0.17113627719177854, 1.5000000000000002e-07], [93431, 2.2110517788806754e-11, 1.2499999999999999e-06, 0.16324043018775308, 1.5000000000000002e-07], [95454, 1.6040213900490875e-11, 1.5e-06, 0.16119148188312638, 1.5000000000000002e-07], [99710, 1.4888759709721926e-11, 1.7500000000000002e-06, 0.15371907014774855, 1.5000000000000002e-07], [88350, 1.6040213900490875e-11, 2e-06, 0.15240563822042513, 1.5000000000000002e-07], [91209, 1.6040213900490875e-11, 2.25e-06, 0.14771318256176363, 1.5000000000000002e-07], [95048, 1.6040213900490875e-11, 2.5e-06, 0.14374845364633726, 1.5000000000000002e-07]]
filestr = '2015-06-25_12h31.json'

N_hmin_Rz_Javg_pnp_300bmV = [[71331, 2.0230848885008857e-11, 2.5000000000000004e-07, 14405.775145053138], [75271, 1.8174227399141578e-11, 4.7500000000000006e-07, 13897.776071683076], [67935, 2.266257618208641e-11, 7.000000000000001e-07, 13330.970512420434], [78765, 1.915761695169014e-11, 9.250000000000001e-07, 12568.939737882498], [77289, 2.0203106670265997e-11, 1.15e-06, 12308.363330891436], [74903, 1.518976093305987e-11, 1.375e-06, 11520.362118755053], [76111, 2.1397831920132284e-11, 1.6000000000000004e-06, 11040.094142502472], [76781, 1.518976093305987e-11, 1.8250000000000003e-06, 11055.90397226459], [64151, 2.4029311418211266e-11, 2.0500000000000003e-06, 10685.543175591705], [64875, 2.4029311418211266e-11, 2.2750000000000002e-06, 10316.842348299298], [66385, 2.4029311418211266e-11, 2.5e-06, 9983.670404742836]]
filestr = '2015-06-26_12h13.json'

N_hmin_Rz_bV_rzv_pnp_300bmV = [[71331, 2.0230848885008857e-11, 2.5000000000000004e-07, 0.2768593076103677, 1.5000000000000002e-07], [75271, 1.8174227399141578e-11, 4.7500000000000006e-07, 0.26681574479779974, 1.5000000000000002e-07], [67935, 2.266257618208641e-11, 7.000000000000001e-07, 0.25667744182537366, 1.5000000000000002e-07], [78765, 1.915761695169014e-11, 9.250000000000001e-07, 0.24257369451862165, 1.5000000000000002e-07], [77289, 2.0203106670265997e-11, 1.15e-06, 0.23806789961260355, 1.5000000000000002e-07], [74903, 1.518976093305987e-11, 1.375e-06, 0.22422709963017831, 1.5000000000000002e-07], [76111, 2.1397831920132284e-11, 1.6000000000000004e-06, 0.21524062902380076, 1.5000000000000002e-07], [76781, 1.518976093305987e-11, 1.8250000000000003e-06, 0.21441219955536475, 1.5000000000000002e-07], [64151, 2.4029311418211266e-11, 2.0500000000000003e-06, 0.20732634978190495, 1.5000000000000002e-07], [64875, 2.4029311418211266e-11, 2.2750000000000002e-06, 0.20055971539409781, 1.5000000000000002e-07], [66385, 2.4029311418211266e-11, 2.5e-06, 0.19439703383562784, 1.5000000000000002e-07]]
filestr = '2015-06-26_12h13.json'

N_hmin_Rz_Javg_pnp_100bmV = [[61139, 2.2607671170539688e-11, 2.5000000000000004e-07, 4458.176089412759], [69037, 2.023084888492844e-11, 4.7500000000000006e-07, 4282.601595096601], [64993, 1.518976093305987e-11, 7.000000000000001e-07, 4091.57819188933], [69739, 2.023084888492844e-11, 9.250000000000001e-07, 3660.848078720077], [70539, 2.1397831920160176e-11, 1.15e-06, 3772.70117447781], [65063, 2.2649524279772168e-11, 1.375e-06, 3277.8359554281815], [65925, 2.2649524279772168e-11, 1.6000000000000004e-06, 3073.079422438228], [68265, 2.2649524279772168e-11, 1.8250000000000003e-06, 3262.955880152805], [79321, 2.1376402415250786e-11, 2.0500000000000003e-06, 3129.3646023302304], [79969, 2.1376402415250786e-11, 2.2750000000000002e-06, 2988.301857105921], [65505, 2.4029311418211266e-11, 2.5e-06, 2857.116545654686]]
filestr = '2015-06-26_12h57.json'

N_hmin_Rz_bV_rzv_pnp_100bmV = [[61139, 2.2607671170539688e-11, 2.5000000000000004e-07, 0.090299851889925065, 1.5000000000000002e-07], [69037, 2.023084888492844e-11, 4.7500000000000006e-07, 0.086359369530902494, 1.5000000000000002e-07], [64993, 1.518976093305987e-11, 7.000000000000001e-07, 0.082342451970478445, 1.5000000000000002e-07], [69739, 2.023084888492844e-11, 9.250000000000001e-07, 0.074312271974463731, 1.5000000000000002e-07], [70539, 2.1397831920160176e-11, 1.15e-06, 0.076458402111593299, 1.5000000000000002e-07], [65063, 2.2649524279772168e-11, 1.375e-06, 0.066364705058975293, 1.5000000000000002e-07], [65925, 2.2649524279772168e-11, 1.6000000000000004e-06, 0.062409902178691704, 1.5000000000000002e-07], [68265, 2.2649524279772168e-11, 1.8250000000000003e-06, 0.065895603054503746, 1.5000000000000002e-07], [79321, 2.1376402415250786e-11, 2.0500000000000003e-06, 0.06315378246533758, 1.5000000000000002e-07], [79969, 2.1376402415250786e-11, 2.2750000000000002e-06, 0.0603634113111087, 1.5000000000000002e-07], [65505, 2.4029311418211266e-11, 2.5e-06, 0.057928342698581707, 1.5000000000000002e-07]]
filestr = '2015-06-26_12h57.json'

N_hmin_Rz_Javg_pnp_300bmV_120k = [[102335, 1.1324762285112855e-11, 2.5000000000000004e-07, 14504.029685208588], [107549, 1.0698914933283909e-11, 4.7500000000000006e-07, 14314.462188542326], [92643, 1.1331287365045255e-11, 7.000000000000001e-07, 13299.052042346522], [110894, 1.1331287365045255e-11, 9.250000000000001e-07, 13149.090750653759], [106943, 1.2014654989645395e-11, 1.15e-06, 12498.959564186192], [102973, 1.201342503044487e-11, 1.375e-06, 11533.081574926531], [104438, 1.201342503044487e-11, 1.6000000000000004e-06, 11051.250393636472], [103701, 1.1331287945845025e-11, 1.8250000000000003e-06, 11018.574708993521], [110857, 1.1331287945845025e-11, 2.0500000000000003e-06, 10584.942748146479], [111405, 1.1331287945845025e-11, 2.2750000000000002e-06, 10272.428092626797], [112657, 1.1331287945845025e-11, 2.5e-06, 9939.561606918502]]
filestr = '2015-06-26_13h48.json'

N_hmin_Rz_bV_rzv_pnp_300bmV_120k = [[102335, 1.1324762285112855e-11, 2.5000000000000004e-07, 0.27859280884344334, 1.5000000000000002e-07], [107549, 1.0698914933283909e-11, 4.7500000000000006e-07, 0.2747070149266635, 1.5000000000000002e-07], [92643, 1.1331287365045255e-11, 7.000000000000001e-07, 0.25672184271431281, 1.5000000000000002e-07], [110894, 1.1331287365045255e-11, 9.250000000000001e-07, 0.25342868477056457, 1.5000000000000002e-07], [106943, 1.2014654989645395e-11, 1.15e-06, 0.24173996284643431, 1.5000000000000002e-07], [102973, 1.201342503044487e-11, 1.375e-06, 0.22419568820650726, 1.5000000000000002e-07], [104438, 1.201342503044487e-11, 1.6000000000000004e-06, 0.21520992007426035, 1.5000000000000002e-07], [103701, 1.1331287945845025e-11, 1.8250000000000003e-06, 0.21447266976747914, 1.5000000000000002e-07], [110857, 1.1331287945845025e-11, 2.0500000000000003e-06, 0.20653820586360069, 1.5000000000000002e-07], [111405, 1.1331287945845025e-11, 2.2750000000000002e-06, 0.20072068079207284, 1.5000000000000002e-07], [112657, 1.1331287945845025e-11, 2.5e-06, 0.19450351091248871, 1.5000000000000002e-07]]
filestr = '2015-06-26_13h48.json'

N_hmin_Rz_Javg_pnp_300bmV_40k = [[34209, 7.650164248055631e-11, 2.5000000000000004e-07, 14501.001424507876], [35665, 6.894973051600119e-11, 4.7500000000000006e-07, 13935.028970495232], [37179, 5.1005650020079295e-11, 7.000000000000001e-07, 13454.861663184489], [38259, 7.663046931022851e-11, 9.250000000000001e-07, 12585.077103441396], [38927, 8.081242697802631e-11, 1.15e-06, 12328.819514480187], [39753, 7.66304693102555e-11, 1.375e-06, 11561.465689834546], [36455, 8.354192383616643e-11, 1.6000000000000004e-06, 11102.397090621405], [37551, 8.354192204286813e-11, 1.8250000000000003e-06, 11138.67695323236], [38197, 8.357295800520699e-11, 2.0500000000000003e-06, 10746.347706330384], [39191, 8.348206876968968e-11, 2.2750000000000002e-06, 10372.802324476415], [38549, 8.315824118148803e-11, 2.5e-06, 10041.1339094519]]
filestr = '2015-06-26_14h45.json'

N_hmin_Rz_bV_rzv_pnp_300bmV_40k = [[34209, 7.650164248055631e-11, 2.5000000000000004e-07, 0.27683307326622369, 1.5000000000000002e-07], [35665, 6.894973051600119e-11, 4.7500000000000006e-07, 0.26689835815092711, 1.5000000000000002e-07], [37179, 5.1005650020079295e-11, 7.000000000000001e-07, 0.25650857373941993, 1.5000000000000002e-07], [38259, 7.663046931022851e-11, 9.250000000000001e-07, 0.24254019739120883, 1.5000000000000002e-07], [38927, 8.081242697802631e-11, 1.15e-06, 0.23793086844106948, 1.5000000000000002e-07], [39753, 7.66304693102555e-11, 1.375e-06, 0.22402449968665566, 1.5000000000000002e-07], [36455, 8.354192383616643e-11, 1.6000000000000004e-06, 0.21494469281630826, 1.5000000000000002e-07], [37551, 8.354192204286813e-11, 1.8250000000000003e-06, 0.21403374102998368, 1.5000000000000002e-07], [38197, 8.357295800520699e-11, 2.0500000000000003e-06, 0.20715128636530253, 1.5000000000000002e-07], [39191, 8.348206876968968e-11, 2.2750000000000002e-06, 0.20032875528069072, 1.5000000000000002e-07], [38549, 8.315824118148803e-11, 2.5e-06, 0.19414844682769677, 1.5000000000000002e-07]]
filestr = '2015-06-26_14h45.json'

N_hmin_Rz_Javg_pnps_300bmV_40k = [[34211, 7.650164248055631e-11, 2.5000000000000004e-07, 14250.10236545602], [35777, 6.894973051600119e-11, 4.7500000000000006e-07, 13742.510916541567], [37189, 4.805370213623322e-11, 7.000000000000001e-07, 13303.518331402574], [38245, 7.663046931022851e-11, 9.250000000000001e-07, 12490.736393813939], [38933, 8.081242697802631e-11, 1.15e-06, 12252.692876363584], [39771, 7.66304693102555e-11, 1.375e-06, 11526.645271623407], [36485, 8.354192383616643e-11, 1.6000000000000004e-06, 11079.970761503622], [37649, 8.354192204286813e-11, 1.8250000000000003e-06, 11115.75540854358], [38189, 8.357295800520699e-11, 2.0500000000000003e-06, 10742.25203836698], [39259, 8.348206876968968e-11, 2.2750000000000002e-06, 10378.744016255081], [38591, 8.315824118148803e-11, 2.5e-06, 10057.17067790051]]
filestr = '2015-06-26_16h23.json'

N_hmin_Rz_bV_rzv_pnps_300bmV_40k = [[34211, 7.650164248055631e-11, 2.5000000000000004e-07, 0.27702321192674034, 1.5000000000000002e-07], [35777, 6.894973051600119e-11, 4.7500000000000006e-07, 0.26711259269712134, 1.5000000000000002e-07], [37189, 4.805370213623322e-11, 7.000000000000001e-07, 0.25673226469638705, 1.5000000000000002e-07], [38245, 7.663046931022851e-11, 9.250000000000001e-07, 0.24271829067495759, 1.5000000000000002e-07], [38933, 8.081242697802631e-11, 1.15e-06, 0.23809676095862925, 1.5000000000000002e-07], [39771, 7.66304693102555e-11, 1.375e-06, 0.22411791334945869, 1.5000000000000002e-07], [36485, 8.354192383616643e-11, 1.6000000000000004e-06, 0.21501620163359428, 1.5000000000000002e-07], [37649, 8.354192204286813e-11, 1.8250000000000003e-06, 0.21410824014068058, 1.5000000000000002e-07], [38189, 8.357295800520699e-11, 2.0500000000000003e-06, 0.20717363038108555, 1.5000000000000002e-07], [39259, 8.348206876968968e-11, 2.2750000000000002e-06, 0.20031792428469844, 1.5000000000000002e-07], [38591, 8.315824118148803e-11, 2.5e-06, 0.19409339489049268, 1.5000000000000002e-07]]
filestr = '2015-06-26_16h23.json'



qoilist = [
    N_hmin_Rz_bV_rzv_pnp_100bmV,
    N_hmin_Rz_bV_rzv_pnp_200bmV,
    N_hmin_Rz_bV_rzv_pnp_300bmV,
    N_hmin_Rz_bV_rzv_pnp_300bmV_120k,
    N_hmin_Rz_bV_rzv_pnp_300bmV_40k,
    N_hmin_Rz_bV_rzv_pnps_300bmV_40k,
]
    
qoilist2 = [
    N_hmin_Rz_Javg_pnp_100bmV,
    N_hmin_Rz_Javg_pnp_200bmV,
    N_hmin_Rz_Javg_pnp_300bmV,
    N_hmin_Rz_Javg_pnp_300bmV_120k,
    N_hmin_Rz_Javg_pnp_300bmV_40k,
    N_hmin_Rz_Javg_pnps_300bmV_40k,
]

aV=[0.1, 0.2, 0.3, 0.3, 0.3, 0.3]

sleg = [
    "pnp w electrodes 80k 100mV",
    "pnp w electrodes 100k 200mV",
    "pnp w electrodes 80k 300mV",
    "pnp w electrodes 120k 300mV",
    "pnp w electrodes 40k 300mV",
    "pnps w electrodes 40k 300mV",
]

sinfo = {
    "bulkcon_debye": [
        400.0, 
        4.894861258082847e-10
    ], 
    "comptime": 1664.2164430618286, 
    "datetime": "2015-06-26 12:54:58.232099", 
    "geo_name": "W_2D_geo", 
    "rzvm": -1.5000000000000002e-07, 
    "solvers": [
        "PNP"
    ],
}


for i in range(len(qoilist)):
    qoi = qoilist[i]
    N=[]
    hmin=[]
    distz=[]
    bV=[]
    
    for j in range(len(qoi)):
        N.append(qoi[j][0])
        hmin.append(qoi[j][1])
        distz.append(qoi[j][2]*2*1e9)
        bV.append(qoi[j][3])

    plt.figure(1)
    plt.plot(distz, bV, 'x-', label=sleg[i] )
    plt.xlabel(slabel[2])
    plt.ylabel(slabel[3])
    legend = plt.legend() #loc='lower right')

for i in range(len(qoilist)):
    qoi = qoilist[i]
    N=[]
    hmin=[]
    distz=[]
    bV=[]
    
    for j in range(len(qoi)):
        N.append(qoi[j][0])
        hmin.append(qoi[j][1])
        distz.append(qoi[j][2]*2*1e9)
        bV.append(qoi[j][3]/float(aV[i]))

    plt.figure(2)
    plt.plot(distz, bV, 'x-', label=sleg[i] )
    plt.xlabel(slabel[2])
    plt.ylabel("bV in percent of applied Voltage")
    legend = plt.legend() #loc='lower right')


for i in range(len(qoilist2)):
    qoi = qoilist2[i]
    distz=[]
    J=[]

    for j in range(len(qoi)):
        distz.append(qoi[j][2]*2*1e9)
        J.append(qoi[j][3])

    plt.figure(3)
    plt.plot(distz, J, 's-', label=sleg[i] )
    plt.xlabel(slabel[2])
    plt.ylabel("Javg")
    legend = plt.legend() #loc='upper left')
    
plt.show()
